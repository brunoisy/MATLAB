addpath('LSQ fit')
addpath('RANSAC fit')

xlimits = [0, 150];
ylimits = [-300, 50];
rng(3)

directory = 'data_4';
load(strcat('data/FD profiles/',directory,'.mat'))

%%% clustering with RANSAC
n = 5;
Lcs_cluster = cell2mat(Lcs(Lcs_lengths == n)')';

ninliers = zeros(1,length(threshs));
variance = zeros(1,length(threshs));
props_inliers = (1:length(Lcs_cluster(1,:)))/length(Lcs_cluster(1,:));

for prop_inliers = props_inliers
    thresh = threshs(i);
    [~, inliers, ~, MSE] = ransac_clustering2(Lcs_cluster,@fittingfn_clustering,@distfn_clustering,thresh, prop_inliers, true);
    ninliers(i) = length(inliers);
    variance(i) = MSE;
end
figure
hold on
plot(prop_,ninliers);
plot(threshs,variance);
legend('ninliers','variance');
xlabel('TSE threshold');